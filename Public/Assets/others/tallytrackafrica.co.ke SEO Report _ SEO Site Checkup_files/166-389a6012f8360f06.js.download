"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{71186:function(e,t,r){r.d(t,{YR:function(){return d},b8:function(){return g},kV:function(){return p},r:function(){return m},vy:function(){return v},wc:function(){return w},z2:function(){return h}});var n=r(50029),a=r(87794),o=r.n(a),s=r(47438),i=r(44767),u=r(68266),c={path:"/",domain:s.x5,sameSite:"strict"},l=function(e){var t=JSON.stringify(e);e.access_token&&e.refresh_token&&(0,i.d8)(s.HI,t,c)},f=function(){return(0,i.hI)(s.HI)},p=function(){return(0,i.nJ)(s.HI,c)},h=function(){var e=(0,n.Z)(o().mark((function e(t,r,n,a,i){var c,l,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.toLowerCase(),e.next=3,fetch("".concat(s.FT,"/user"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({u_name:c,f_name:r,l_name:n,pw:a,email:c,token:i,locale:"en_US",timezone:"America/New_York"})});case 3:if(201!==(l=e.sent).status){e.next=12;break}return e.next=7,l.json();case 7:return f=e.sent,(0,u.mH)(f.guid),e.abrupt("return",Promise.resolve(201));case 12:if(200!==l.status){e.next=16;break}return e.abrupt("return",Promise.resolve(200));case 16:return e.abrupt("return",Promise.reject({status:l.status}));case 17:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.Z)(o().mark((function e(t,r){var n,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,i.nJ)(s.HI,c),n=t.toLowerCase(),e.next=4,fetch("".concat(s.FT,"/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_name:n,password:r})});case 4:if(201!==(a=e.sent).status){e.next=12;break}return e.next=8,a.json();case 8:u=e.sent,l(u),e.next=13;break;case 12:return e.abrupt("return",Promise.reject());case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.toLowerCase(),e.next=3,fetch("".concat(s.FT,"/user/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({u_name:r})});case 3:if(200===e.sent.status){e.next=6;break}return e.abrupt("return",Promise.reject());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,n.Z)(o().mark((function e(t){var r,n,a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(s.FT,"/federated-auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:t.provider,token:t.token})});case 2:if(201!==(r=e.sent).status){e.next=11;break}return e.next=6,r.json();case 6:if(n=e.sent,l(n),"register"===t.scope)try{a=n.access_token,i=JSON.parse(atob(a.split(".")[1])),c=i.identity,(0,u.mH)(c)}catch(o){}e.next=12;break;case 11:throw Error("Cannot sign in with ".concat(t.provider,"!"));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,n.Z)(o().mark((function e(){var t,r,n,a,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f()){e.next=3;break}return e.abrupt("return",null);case 3:if(e.prev=3,r=t.access_token,n=JSON.parse(atob(r.split(".")[1])),"expired"===(a=n.user_claims).subscription.status||!a.subscription.plan_code){e.next=13;break}return i=n.identity,u="".concat(s.FT,"/user/").concat(i),e.next=12,y(u,t.access_token,t.refresh_token);case 12:return e.abrupt("return",e.sent);case 13:return e.abrupt("return",null);case 16:return e.prev=16,e.t0=e.catch(3),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=f();if(!e)return!1;try{var t=e.access_token;return!!JSON.parse(atob(t.split(".")[1])).user_claims.subscription.plan_code}catch(r){return!1}},_=function(){var e=(0,n.Z)(o().mark((function e(t){var r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}},e.next=3,fetch("".concat(s.FT,"/auth/refresh"),n);case 3:if((a=e.sent).ok){e.next=6;break}return e.abrupt("return",Promise.reject());case 6:if(201!==a.status){e.next=13;break}return e.next=9,a.json();case 9:return r=e.sent,e.abrupt("return",r.access_token);case 13:return e.abrupt("return",Promise.reject());case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,n.Z)(o().mark((function e(t,r,n){var a,s,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}},e.next=3,fetch(t,a);case 3:if(s=e.sent,[200,201,401].includes(s.status)){e.next=6;break}return e.abrupt("return",Promise.reject());case 6:if(![200,201].includes(s.status)){e.next=10;break}return e.next=9,s.json();case 9:case 25:return e.abrupt("return",e.sent);case 10:if(401!==s.status){e.next=29;break}return e.next=13,_(n);case 13:if(i=e.sent){e.next=16;break}return e.abrupt("return",Promise.reject());case 16:return l({access_token:i,refresh_token:n}),a.headers.Authorization="Bearer ".concat(i),e.next=21,fetch(t,a);case 21:if(u=e.sent,![200,201].includes(u.status)){e.next=28;break}return e.next=25,u.json();case 28:return e.abrupt("return",Promise.reject());case 29:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},9166:function(e,t,r){r.r(t),r.d(t,{isFullReport:function(){return c},setDefaultLastFullReport:function(){return h},setLastFullReportFromOverview:function(){return d},setLastReport:function(){return v},setOnboardingWizardUrlCookie:function(){return g},shouldApplyFullAnalysisLimitation:function(){return l},shouldApplyPartialAnalysisLimitation:function(){return f},shouldRedirectToSavedReport:function(){return p}});var n=r(51887),a=r.n(n),o=r(49992),s=r(44767),i=r(47438),u=r(71186),c=function(e){return!(!e||!("sections"in e))&&0===e.sections.length},l=function(){var e=new o.ClientPersistence,t=e.getJson("report_in_progress"),r=e.getJson("last_full_report");if(c(t)&&r){var n=r.createdAt;if(Math.floor(Date.now()/1e3)-n<86400)return{name:"full_analysis",until:n+86400}}return null},f=function(){if((0,u.wc)())return null;var e=new o.ClientPersistence,t=e.getJson("report_in_progress"),r=e.getJson("last_report");if(!t||!r)return null;if(!c(t)&&!c(r)){var n=r.createdAt;if(Math.floor(Date.now()/1e3)-n<3600)return{name:"partial_analysis",until:n+3600}}return null},p=function(){var e=new o.ClientPersistence,t=e.getJson("report_in_progress"),r=e.getJson("last_report"),n=e.getJson("last_full_report");return!t&&(!(!r||!n)&&(r.mainUrl===n.mainUrl&&r.createdAt===n.createdAt))},h=function(){var e=new o.ClientPersistence,t={mainUrl:"",competitorUrl:"",sections:[]};e.saveJson("last_full_report",t);var r=(new(a().MD5)).hex(JSON.stringify(t));e.save("crc",r)},d=function(e){var t=new o.ClientPersistence;if(e){var r={mainUrl:e.url,competitorUrl:"",sections:[],createdAt:e.created_at,overview:e};t.saveJson("last_full_report",r);var n=(new(a().MD5)).hex(JSON.stringify(r));t.save("crc",n)}else h()},v=function(e){if(e&&"url"in e&&"c_at"in e){var t=new o.ClientPersistence,r={mainUrl:e.url,competitorUrl:"",createdAt:e.c_at};t.saveJson("last_report",r)}},g=function(e){var t={path:"/",domain:i.x5,sameSite:"strict"};(0,s.d8)("default_url",e,t)}},68266:function(e,t,r){function n(e){"gtag"in window&&window.gtag("event","run_analysis",{category:"acquisition",label:e})}function a(e,t){"gtag"in window&&window.gtag("event","run_one_tool_analysis",{category:"seo_analysis",url:e,seo_test:t})}function o(e){"gtag"in window&&window.gtag("event","user_registration",{category:"acquisition",label:e})}r.d(t,{Q7:function(){return a},bm:function(){return n},mH:function(){return o}})},49992:function(e,t,r){r.r(t),r.d(t,{ClientPersistence:function(){return s}});var n=r(82262),a=r(92777),o=r(59499),s=(0,n.Z)((function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage";(0,a.Z)(this,e),(0,o.Z)(this,"persistenceType","localStorage"),(0,o.Z)(this,"save",(function(e,r){if("localStorage"===t.persistenceType)return t.saveToLocalStorage(e,r)})),(0,o.Z)(this,"saveJson",(function(e,r){if("localStorage"===t.persistenceType)return t.saveJsonToLocalStorage(e,r)})),(0,o.Z)(this,"get",(function(e){return"localStorage"===t.persistenceType?t.getFromLocalStorage(e):null})),(0,o.Z)(this,"getJson",(function(e){return"localStorage"===t.persistenceType?t.getJsonFromLocalStorage(e):null})),(0,o.Z)(this,"remove",(function(e){if("localStorage"===t.persistenceType)return t.removeFromLocalStorage(e)})),(0,o.Z)(this,"saveToLocalStorage",(function(e,t){window.localStorage.setItem(e,t)})),(0,o.Z)(this,"saveJsonToLocalStorage",(function(e,t){window.localStorage.setItem(e,JSON.stringify(t))})),(0,o.Z)(this,"getFromLocalStorage",(function(e){return window.localStorage.getItem(e)})),(0,o.Z)(this,"getJsonFromLocalStorage",(function(e){var t=window.localStorage.getItem(e);return t?JSON.parse(t):null})),(0,o.Z)(this,"removeFromLocalStorage",(function(e){window.localStorage.removeItem(e)})),this.persistenceType=r}))},44767:function(e,t,r){r.d(t,{d8:function(){return a},hI:function(){return o},nJ:function(){return s}});var n=r(31955);function a(e,t,r){return n.Z.set(e,t,r)}function o(e){var t=n.Z.get(e);if(t)try{return JSON.parse(t)}catch(r){return null}return null}function s(e,t){n.Z.remove(e,t)}}}]);